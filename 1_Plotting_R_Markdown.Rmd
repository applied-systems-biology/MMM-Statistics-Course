---
title: "Basic plotting"
output:
  html_document:
    df_print: paged
  pdf_document: default
  html_notebook: default
date: "2025-03-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

The information up until here is pre-generated by RStudio and will appear every time you create a new Markdown or Notebook file. I've left it in here as it actually contain some useful information. From here on we will again look at the iris dataset as in Plotting_R_script.R and repeat what you did there to high-light differences. After the repetition of loading and plotting data, there are additional tasks to do with the data.

## Differences between scripts and Markdown

As you probably already noticed, is text that is somewhere in this document not automatically interpreted as code. This naturally allow for a much more complex structure in explaining the data, project and analysis that you doing. Working in Markdown document in practice means that you are writing a report as you are coding. This report, with or without code visible, can be converted into a html or pdf document by clicking the Preview or Knit command in the list above. You can also typeset your text to be *italic* or **bold** using normal [Markdown syntax](https://www.markdownguide.org/basic-syntax/). It also have LaTeX support, but this requires you to have a working TeX/LaTeX interpreter on your system, so this will not be covered here. In short, whether you are reading this text directly in the RStudio editor, in the generated html notebook, static html document or pdf document, this is a much more read friendly version than an R-script. However, as stated in the R-script, if you are processing a lot of data and need to do that in a headless manner to feed results into additional processes, you might be better off writing an R-script. 

First of all, check that you can generate at least a HTML-file from this file, either by "Preview Notebook" or "Knit to HTML". "Knit to PDF" is often a bit trickier to get working, you are welcome to try it, but don't spend too much time trying to fix it if it fails.

Now we have spoke a lot about the typesetting and output of the R Markdown style, how do we actually code and are there any advantages compared to a script. All code has to be included in a code chunk like the one below. If you are reading this in the preview/knitted view, you should find this bit in the source code.

```{r import libraries, echo = TRUE, message=FALSE}
rm(list = ls()) # This clear all R-history and should be included in all code
library(dplyr)  # Library for more elegant data handling
library(ggplot2)# Powerful plotting library
```

At the top right of the code chunk, you have a few buttons for interaction. You can run all code above the current chunk or Run current chunk. The latter can also be done by placing your cursor anywhere in the chunk and pressing CTRL+Shift+Enter. This way you can run and re-run code pieces that are connected without having to mark multiple lines or run code line-by-line like in a script. You also see in the code above that you still can insert comments about code specifics and then write longer and more general things in between the code chunks. Normally, you don't want too much code in your report so feel free to remove the code in the chunk *include libraries* by setting *echo = False*. Not that if you want to knit the Notebook into a html or pdf-document, you have to name each individual code chunk in a individual way.

Below we load the [iris dataset](https://en.wikipedia.org/wiki/Iris_flower_data_set). This is an example dataset that is "embedded" in R that is widely used for tutorials in machine learning, plotting and statistics. It describe the shapes of a number of species of Iris flowers by their petal and sepal morphologies. When the dataset is loaded, you will see that in the top right panel of RStudio you have the *iris* data show up. What happens when you click on that?

```{r import iris dataset, echo = FALSE, message=FALSE}
  # Load the R example dataset iris
  data(iris)
  head(iris) # head() shows the frist rows of a  
```

We can quickly extract some statistics about the dataset. Answer these questions:

What is the mean Sepal Width?

What is the max Petal Length?

How many Species of Iris are there in the dataset? 

You can choose where you write the code to do this. You can do it in the console in the bottom panel of RStudio. This is quick and good for trying stuff, but not very reproducible. You can also do it in the code chunk above where we loaded and printed the head of the dataset or you can create a new code chunk where you find it appropriate.

Hint 1: To access a specific column you use the syntax *iris$Species*. After that you can probably figure out what commands to use to answer the questions.

Hint 2: There is one command that will give you the answer to all the question. That command gives a summary of the data frame. However, it is probably a good idea to try to answer the questions individually. 


## Visualizing the Iris dataset

Now we are actually back to the Iris data set and plotting it like we did in the R-script. We create a code chunk to do this.
```{r plot iris 1, echo=FALSE, message=FALSE}

  # Make a boxplot of Sepal.Width for the different Species of irises
  ggplot(aes(x=Species, y=Sepal.Width), data=iris) + geom_boxplot()
```

The first thing we notice is that the plot does appear just below the code chunk and not in the bottom right panel. You might already have seen this earlier where the *pressure* was plotted in the RStudio basic introduction to Markdown. It is also introduced as a plot in the output html-document on the place where the code is added in the text. Note that we can show output from the code chunks, plots or text, with or without showing the code.

Your first task is to make a scatter plot of Sepal.Width (x axis) vs. Sepal.Length (y axis). The *ggplot* command to do scatter/point plots is geom_point().
```{r scatter 1, echo=TRUE, message=FALSE}
  # Make a scatter plot of Sepal.Width vs. Sepal.Width for the iris dataset

```

Once you have the scatter plot, your next task is to color code the points in the scatter plot so that we see which species each point represent. Hint: The type ?geom_point and look for Aesthetics part.

You have now completed the basic part about R markdown and plotting. You are naturally welcome to play around with more options and test things. Especially if you finished this in 10 minutes.